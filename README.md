# EventHub

EventHub ‚Äî backend-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è–º–∏, –±–∏–ª–µ—Ç–∞–º–∏ –∏ –∑–∞–∫–∞–∑–∞–º–∏ —Å JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π, —Ä–æ–ª–µ–≤–æ–π –º–æ–¥–µ–ª—å—é –¥–æ—Å—Ç—É–ø–∞ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ–ø–ª–∞—Ç—ã.

–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –Ω–∞ **Spring Boot Java + Kotlin**, —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **Spring Security (JWT)**, **Spring Data JPA**, **PostgreSQL**.

---

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (JWT)
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
- –†–æ–ª–µ–≤–æ–π –¥–æ—Å—Ç—É–ø (USER / ORGANIZER / ADMIN)
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ **permissions**
### –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è

- –°–æ–∑–¥–∞–Ω–∏–µ, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π
- –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –±–∏–ª–µ—Ç–æ
- Optimistic Lock –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç oversell

### –ó–∞–∫–∞–∑—ã –∏ –±–∏–ª–µ—Ç—ã

- –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π
- –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∏–ª–µ—Ç–æ–≤
- –û–ø–ª–∞—Ç–∞ –∑–∞–∫–∞–∑–∞
- –ê–≤—Ç–æ–æ—Ç–º–µ–Ω–∞ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π (scheduler)
- –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ –∫ –∑–∞–∫–∞–∑–∞–º

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- JWT (stateless)
- Custom `UserDetailsService`
- –ì—Ä–∞–Ω—É–ª—è—Ä–Ω—ã–µ permissions (`@PreAuthorize`)
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

---

## üß± –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Kotlin**
- **Java**
- **Spring Boot**
- **Spring Security (JWT)**
- **Spring Data JPA (Hibernate)**
- **PostgreSQL**
- **Jackson**
- **Maven**
- **Docker**
- **Gitlab CI/CD**

---

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

### JWT

- Stateless-–ø–æ–¥—Ö–æ–¥
- –¢–æ–∫–µ–Ω –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ:

`Authorization: Bearer <jwt-token>`

### Flow

1. `/api/v1/auth/register` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
2. `/api/v1/auth/login` ‚Äî –ª–æ–≥–∏–Ω, –ø–æ–ª—É—á–µ–Ω–∏–µ JWT
3. JWT –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è **–Ω–∞ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ** —á–µ—Ä–µ–∑ `JwtAuthenticationFilter`
4. `SecurityContext` –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è `Authentication`
5. –î–æ—Å—Ç—É–ø –∫ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω —á–µ—Ä–µ–∑ `@PreAuthorize`    

---

## üß© –†–æ–ª–∏ –∏ permissions

### Permissions

`USER_READ, USER_UPDATE, USER_DELETE EVENT_READ, EVENT_CREATE, EVENT_UPDATE, EVENT_DELETE ORDER_CREATE, ORDER_READ, ORDER_CANCEL, ORDER_PAY`

### –†–æ–ª–∏

- **USER** ‚Äî –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- **ORGANIZER** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è–º–∏
- **ADMIN** ‚Äî –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø

–ö–∞–∂–¥–∞—è —Ä–æ–ª—å —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞–±–æ—Ä permissions.

---

## üì° API (–æ—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã)

### Auth

`POST /api/v1/auth/register POST /api/v1/auth/login`

### Users

`GET    /api/v1/users GET    /api/v1/users/search PATCH  /api/v1/users DELETE /api/v1/users`

### Events

`GET    /api/v1/events GET    /api/v1/events/search POST   /api/v1/events PATCH  /api/v1/events/{id} DELETE /api/v1/events/{id}`

### Orders

`POST   /api/v1/orders GET    /api/v1/orders/my GET    /api/v1/orders/search POST   /api/v1/orders/{id}/pay POST   /api/v1/orders/{id}/cancel`

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### application.yml

`spring:   datasource:     url: jdbc:postgresql://localhost:5432/eventhub_db     username: postgres     password: postgres    jpa:     hibernate:       ddl-auto: update     show-sql: true  jwt:   secret: super-long-random-256-bit-key   validity: 3600000`

---

## üõë –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- `@RestControllerAdvice`
- –ö–∞—Å—Ç–æ–º–Ω—ã–µ exception'—ã
- –í–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ `@Valid`
- Security –æ—à–∏–±–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ (`AuthenticationEntryPoint`)

–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:

`{   "message": "–ó–∞–∫–∞–∑ –Ω–µ –Ω–∞–π–¥–µ–Ω",   "status": 404 }`

---

## üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- Controller ‚Äî —Ç–æ–ª—å–∫–æ HTTP
- Service ‚Äî –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
- Mapper ‚Äî –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ DTO ‚Üî Entity
- Repository ‚Äî –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º
- Security ‚Äî –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω

---

## üß™ –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

- [x]  Security (JWT)
- [x] –†–æ–ª–∏ –∏ permissions
- [x] Orders / Events / Users
- [x] Scheduler
- [ ] Kafka (–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ)
- [ ] Swagger
- [ ] –¢–µ—Å—Ç—ã (–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ)
- [ ] Redis

---

## üìå –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è

- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Kafka (event-driven)
- DLQ –∏ retry-–º–µ—Ö–∞–Ω–∏–∑–º—ã
- OpenAPI / Swagger UI
- –ö–æ–Ω—Ç—Ä–∞–∫—Ç–Ω—ã–µ —Ç–µ—Å—Ç—ã
